<div class="container">
  <h2>{{ isEditMode ? 'Lény szerkesztése' : 'Új lény létrehozása' }}</h2>

  <form [formGroup]="creatureForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="nev">Név</label>
      <input type="text" id="nev" formControlName="nev" class="form-control">
      <div *ngIf="creatureForm.get('nev')?.touched && creatureForm.get('nev')?.invalid" class="error-message">
        A név megadása kötelező
      </div>
    </div>

    <div class="form-group">
      <label for="tudomanyos_nev">Tudományos név</label>
      <input type="text" id="tudomanyos_nev" formControlName="tudomanyos_nev" class="form-control">
    </div>

    <div class="form-group">
      <label for="kategoria_id">Kategória</label>
      <select id="kategoria_id" formControlName="kategoria_id" class="form-control">
        <option value="">Válassz kategóriát</option>
        <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.nev }}</option>
      </select>
    </div>

    <div class="form-group">
      <label for="leiras">Leírás</label>
      <textarea id="leiras" formControlName="leiras" class="form-control" rows="5"></textarea>
    </div>

    <div class="form-group">
      <label for="elohely">Élőhely</label>
      <input type="text" id="elohely" formControlName="elohely" class="form-control">
    </div>

    <div class="form-group">
      <label for="meret">Méret</label>
      <select id="meret" formControlName="meret" class="form-control">
        <option value="">Válassz méretet</option>
        <option value="apró">Apró</option>
        <option value="kicsi">Kicsi</option>
        <option value="közepes">Közepes</option>
        <option value="nagy">Nagy</option>
        <option value="hatalmas">Hatalmas</option>
        <option value="gigantikus">Gigantikus</option>
      </select>
    </div>

    <div class="form-group">
      <label for="veszelyesseg">Veszélyesség</label>
      <select id="veszelyesseg" formControlName="veszelyesseg" class="form-control">
        <option value="">Válassz veszélyességi szintet</option>
        <option value="ártalmatlan">Ártalmatlan</option>
        <option value="alacsony">Alacsony</option>
        <option value="közepes">Közepes</option>
        <option value="magas">Magas</option>
        <option value="extrém">Extrém</option>
      </select>
    </div>

    <div class="form-group">
      <label for="ritkasag">Ritkaság (1-10)</label>
      <input type="number" id="ritkasag" formControlName="ritkasag" class="form-control" min="1" max="10">
    </div>

    <div class="form-group">
      <label for="allapot">Állapot</label>
      <select id="allapot" formControlName="allapot" class="form-control">
        <option value="">Válassz állapotot</option>
        <option value="aktív">Aktív</option>
        <option value="inaktív">Inaktív</option>
        <option value="kivizsgálás_alatt">Kivizsgálás alatt</option>
        <option value="eltűnt">Eltűnt</option>
      </select>
    </div>

    <div class="form-group">
      <label for="felfedezes_datuma">Felfedezés dátuma</label>
      <input type="date" id="felfedezes_datuma" formControlName="felfedezes_datuma" class="form-control">
    </div>

    <div class="form-group">
      <label for="felfedezo">Felfedező</label>
      <input type="text" id="felfedezo" formControlName="felfedezo" class="form-control">
    </div>

    <div class="form-group">
      <label for="kep">Kép feltöltése</label>
      <input type="file" id="kep" (change)="onFileSelected($event)" class="form-control" accept="image/*">
      <small class="form-text text-muted">Csak képfájlokat lehet feltölteni (JPG, PNG, GIF)</small>
      
      <!-- Kép előnézet -->
      <div *ngIf="previewUrl" class="image-preview mt-2">
        <img [src]="previewUrl" alt="Előnézet" style="max-width: 200px; max-height: 200px; object-fit: cover;">
        <button type="button" class="btn btn-sm btn-danger ms-2" (click)="removeImage()">Eltávolítás</button>
      </div>
    </div>

    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

    <div class="form-actions">
      <button type="submit" [disabled]="creatureForm.invalid || loading" class="btn btn-primary">
        {{ isEditMode ? 'Mentés' : 'Létrehozás' }}
      </button>
      <a routerLink="/creatures" class="btn btn-secondary">Mégse</a>
    </div>
  </form>
</div>
